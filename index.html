<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>âš½ å…±äº«èµ›ç¨‹æ—¥å†ç”Ÿæˆå™¨</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body class="bg-gradient-to-br from-gray-100 to-gray-200 min-h-screen flex items-center justify-center p-4">

<div id="app" class="max-w-md w-full bg-white rounded-2xl shadow-xl overflow-hidden">
    <div class="bg-blue-600 p-6 text-white text-center">
        <i class="fa-regular fa-calendar-check text-4xl mb-3"></i>
        <h1 class="text-2xl font-bold">èµ›ç¨‹æ—¥å†ç”Ÿæˆå™¨</h1>
        <p class="text-blue-100 text-sm mt-1">è‡ªåŠ¨åŒæ­¥æ”¹æœŸã€å»¶æœŸï¼Œæ°¸ä¸é”™è¿‡æ¯”èµ›</p>
    </div>

    <div class="p-6 space-y-5">
        <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">é€‰æ‹©è”èµ›</label>
            <select v-model="selectedLeague" class="w-full border border-gray-300 rounded-lg p-3 outline-none focus:ring-2 focus:ring-blue-500 transition">
                <option value="" disabled>è¯·é€‰æ‹©è”èµ›...</option>
                <option v-for="(teams, league) in db" :key="league" :value="league">{{ league }}</option>
            </select>
        </div>

        <div v-if="selectedLeague">
            <label class="block text-sm font-medium text-gray-700 mb-1">é€‰æ‹©çƒé˜Ÿ</label>
            <select v-model="selectedTeam" class="w-full border border-gray-300 rounded-lg p-3 outline-none focus:ring-2 focus:ring-blue-500 transition">
                <option value="" disabled>è¯·é€‰æ‹©ä¸»é˜Ÿ...</option>
                <option v-for="team in db[selectedLeague]" :key="team.id" :value="team">
                    {{ team.name }}
                </option>
            </select>
        </div>

        <div v-if="selectedTeam" class="mt-6 p-4 bg-gray-50 border border-gray-200 rounded-xl">
            <p class="text-xs text-gray-500 font-semibold mb-2 uppercase tracking-wider">ä¸“å±è®¢é˜…é“¾æ¥</p>
            <div class="flex items-center justify-between bg-white border border-gray-200 rounded-lg p-2 overflow-hidden mb-4">
                <span class="text-sm text-gray-600 truncate whitespace-nowrap overflow-x-auto w-full mr-2">
                    {{ generateUrl }}
                </span>
                <button @click="copyLink" class="shrink-0 bg-gray-100 hover:bg-gray-200 text-gray-700 p-2 rounded-md transition" title="å¤åˆ¶é“¾æ¥">
                    <i class="fa-regular fa-copy"></i>
                </button>
            </div>
            
            <div class="grid grid-cols-2 gap-3">
                <a :href="webcalUrl" class="block text-center bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 rounded-lg transition shadow-md shadow-blue-500/30">
                    <i class="fa-brands fa-apple mr-1"></i> iOS/Mac è®¢é˜…
                </a>
                <button @click="copyLink" class="block text-center bg-green-500 hover:bg-green-600 text-white font-medium py-3 rounded-lg transition shadow-md shadow-green-500/30">
                    <i class="fa-brands fa-android mr-1"></i> å¤åˆ¶å®‰å“é“¾æ¥
                </button>
            </div>
            <p class="text-xs text-gray-400 mt-3 text-center">å°†é“¾æ¥ç²˜è´´è‡³ Google/Outlook/æ‰‹æœºè‡ªå¸¦æ—¥å†ä¸­å³å¯</p>
        </div>
    </div>
</div>

<script>
    const { createApp, ref, computed } = Vue;

    createApp({
        setup() {
            // âš ï¸ è¿™é‡Œæœªæ¥éœ€è¦æ›¿æ¢æˆä½ éƒ¨ç½²åœ¨ Vercel ä¸Šçš„çœŸå®åç«¯åœ°å€
            // âœ… å°†è¿™ä¸€è¡Œæ”¹ä¸ºä½ çš„æœ¬åœ°çœŸå®åœ°å€
            // âœ… æ¢æˆä½ çœŸå®çš„ Vercel åŸŸå
            const apiBaseUrl = "https://football-calendar-iggx.vercel.app/api/calendar";
            
            const selectedLeague = ref('');
            const selectedTeam = ref('');

            // æœ¬åœ°å†…ç½®çš„çƒé˜Ÿ ID æ•°æ®åº“ (åŸºäºæ‡‚çƒå¸)
            const db = ref({
                "ğŸ‡¨ğŸ‡³ ä¸­è¶…è”èµ›": [
                    { name: "æˆéƒ½è“‰åŸ", id: "50076899" },
                    { name: "äº‘å—ç‰æ˜†", id: "50117905" },
                    { name: "é’å²›è¥¿æµ·å²¸", id: "50093933" },
                    { name: "å¤§è¿è‹±åš", id: "50122423" },
                    { name: "æ·±åœ³æ–°é¹åŸ", id: "50053965" },
                    { name: "è¾½å®é“äºº", id: "50016400" },
                    { name: "é‡åº†é“œæ¢é¾™", id: "50122484" },
                    { name: "ä¸Šæµ·æµ·æ¸¯", id: "50007190" },
                    { name: "åŒ—äº¬å›½å®‰", id: "50000330" },
                    { name: "æµ™æ±Ÿ", id: "50000341" },
                    { name: "æ­¦æ±‰ä¸‰é•‡", id: "50077677" },
                    { name: "å±±ä¸œæ³°å±±", id: "50000335" },
                    { name: "æ²³å—", id: "50000339" },
                    { name: "é’å²›æµ·ç‰›", id: "50000328" },
                    { name: "ä¸Šæµ·ç”³èŠ±", id: "50000334" },
                    { name: "å¤©æ´¥æ´¥é—¨è™", id: "50000332" }
                ],
                "ğŸ‡¬ğŸ‡§ è‹±æ ¼å…°è¶…çº§è”èµ›": [
                    { name: "é˜¿æ£®çº³", id: "50000513" },
                    { name: "æ›¼åŸ", id: "50000529" },
                    { name: "é˜¿æ–¯é¡¿ç»´æ‹‰", id: "50000518" },
                    { name: "æ›¼è”", id: "50000515" },
                    { name: "åˆ‡å°”è¥¿", id: "50000514" },
                    { name: "åˆ©ç‰©æµ¦", id: "50000516" },
                    { name: "å¸ƒä¼¦ç‰¹ç¦å¾·", id: "50000575" },
                    { name: "åŸƒå¼—é¡¿", id: "50000527" },
                    { name: "ä¼¯æ©èŒ…æ–¯", id: "50000564" },
                    { name: "çº½å¡æ–¯å°”è”", id: "50000517" },
                    { name: "æ¡‘å¾·å…°", id: "50000536" },
                    { name: "å¯Œå‹’å§†", id: "50000520" },
                    { name: "æ°´æ™¶å®«", id: "50000532" },
                    { name: "å¸ƒè±é¡¿", id: "50000556" },
                    { name: "åˆ©å…¹è”", id: "50000534" },
                    { name: "æ‰˜ç‰¹çº³å§†çƒ­åˆº", id: "50000528" },
                    { name: "è¯ºä¸æ±‰æ£®æ—", id: "50000547" },
                    { name: "è¥¿æ±‰å§†è”", id: "50000537" },
                    { name: "ä¼¯æ©åˆ©", id: "50000551" },
                    { name: "ç‹¼é˜Ÿ", id: "50000533" }
                ],
                "ğŸ‡ªğŸ‡¸ è¥¿ç­ç‰™ç”²çº§è”èµ›": [
                    { "name": "çš‡å®¶é©¬å¾·é‡Œ", "id": "50001755" },
                    { "name": "å·´å¡ç½—é‚£", "id": "50001756" },
                    { "name": "é©¬å¾·é‡Œç«æŠ€", "id": "50001759" },
                    { "name": "æ¯”åˆ©äºšé›·äºšå°”", "id": "50001762" },
                    { "name": "çš‡å®¶è´è’‚æ–¯", "id": "50001764" },
                    { "name": "è¥¿ç­ç‰™äºº", "id": "50001771" },
                    { "name": "å¡å°”å¡”", "id": "50001772" },
                    { "name": "çš‡å®¶ç¤¾ä¼š", "id": "50001767" },
                    { "name": "å¥¥è¨è‹çº³", "id": "50001761" },
                    { "name": "èµ«å¡”è´¹", "id": "50001778" },
                    { "name": "æ¯•å°”å·´é„‚ç«æŠ€", "id": "50001758" },
                    { "name": "å¡ç»´åˆ©äºš", "id": "50001760" },
                    { "name": "é˜¿æ‹‰ç»´æ–¯", "id": "50001776" },
                    { "name": "èµ«ç½—çº³", "id": "50001836" },
                    { "name": "åŸƒå°”åˆ‡", "id": "50001782" },
                    { "name": "é©¬ç•¥å¡", "id": "50001766" },
                    { "name": "ç“¦ä¼¦è¥¿äºš", "id": "50001754" },
                    { "name": "å·´åˆ—å¡è¯º", "id": "50001793" },
                    { "name": "è±ä¸‡ç‰¹", "id": "50001775" },
                    { "name": "çš‡å®¶å¥¥ç»´è€¶å¤š", "id": "50002061" }
                ],
                "ğŸ‡©ğŸ‡ª å¾·å›½ç”²çº§è”èµ›": [
                    { "name": "æ‹œä»æ…•å°¼é»‘", "id": "50000804" },
                    { "name": "å¤šç‰¹è’™å¾·", "id": "50000807" },
                    { "name": "éœèŠ¬æµ·å§†", "id": "50000842" },
                    { "name": "æ–¯å›¾åŠ ç‰¹", "id": "50000805" },
                    { "name": "å‹’æ²ƒåº“æ£®", "id": "50000806" },
                    { "name": "RBè±æ¯”é”¡", "id": "50008568" },
                    { "name": "æ³•å…°å…‹ç¦", "id": "50000822" },
                    { "name": "å¼—èµ–å ¡", "id": "50000813" },
                    { "name": "æ±‰å ¡", "id": "50000810" },
                    { "name": "æŸæ—è”åˆ", "id": "50000860" },
                    { "name": "ç§‘éš†", "id": "50000823" },
                    { "name": "é—¨å…´æ ¼æ‹‰å¾·å·´èµ«", "id": "50000814" },
                    { "name": "å¥¥æ ¼æ–¯å ¡", "id": "50000841" },
                    { "name": "ç¾å› èŒ¨", "id": "50000820" },
                    { "name": "æ²ƒå°”å¤«æ–¯å ¡", "id": "50000811" },
                    { "name": "äº‘è¾¾ä¸è±æ¢…", "id": "50000803" },
                    { "name": "åœ£ä¿åˆ©", "id": "50000855" },
                    { "name": "æµ·ç™»æµ·å§†", "id": "50004404" }
                ],
                "ğŸ‡«ğŸ‡· æ³•å›½ç”²çº§è”èµ›": [
                    { "name": "æœ—æ–¯", "id": "50000737" },
                    { "name": "å·´é»åœ£æ—¥è€³æ›¼", "id": "50000731" },
                    { "name": "é‡Œæ˜‚", "id": "50000729" },
                    { "name": "é©¬èµ›", "id": "50000735" },
                    { "name": "é‡Œå°”", "id": "50000740" },
                    { "name": "é›·æ©", "id": "50000738" },
                    { "name": "æ–¯ç‰¹æ‹‰æ–¯å ¡", "id": "50000743" },
                    { "name": "æ‘©çº³å“¥", "id": "50000730" },
                    { "name": "å›¾å¢å…¹", "id": "50000744" },
                    { "name": "æ˜‚çƒ­", "id": "50000763" },
                    { "name": "æ´›é‡Œæ˜‚", "id": "50000752" },
                    { "name": "å¸ƒé›·æ–¯ç‰¹", "id": "50000767" },
                    { "name": "å‹’é˜¿å¼—å°”", "id": "50000757" },
                    { "name": "å°¼æ–¯", "id": "50000739" },
                    { "name": "å·´é»FC", "id": "50002258" },
                    { "name": "æ¬§å¡å°”", "id": "50000733" },
                    { "name": "å—ç‰¹", "id": "50000734" },
                    { "name": "æ¢…æ–¯", "id": "50000741" }
                ],
                "ğŸ‡®ğŸ‡¹ æ„å¤§åˆ©ç”²çº§è”èµ›": [
                    { "name": "å›½é™…ç±³å…°", "id": "50001042" },
                    { "name": "ACç±³å…°", "id": "50001038" },
                    { "name": "é‚£ä¸å‹’æ–¯", "id": "50001068" },
                    { "name": "å°¤æ–‡å›¾æ–¯", "id": "50001040" },
                    { "name": "ç½—é©¬", "id": "50001039" },
                    { "name": "äºšç‰¹å…°å¤§", "id": "50001053" },
                    { "name": "ç§‘è«", "id": "50001081" },
                    { "name": "æ‹‰é½å¥¥", "id": "50001043" },
                    { "name": "ä¹Œè¿ªå†…æ–¯", "id": "50001044" },
                    { "name": "åšæ´›å°¼äºš", "id": "50001047" },
                    { "name": "è¨ç´¢æ´›", "id": "50004293" },
                    { "name": "å¡åˆ©äºšé‡Œ", "id": "50001054" },
                    { "name": "éƒ½çµ", "id": "50001066" },
                    { "name": "å¸•å°”é©¬", "id": "50001041" },
                    { "name": "çƒ­é‚£äºš", "id": "50001074" },
                    { "name": "å…‹é›·è«å†…å¡", "id": "50002065" },
                    { "name": "ä½›ç½—ä¼¦è¨", "id": "50001057" },
                    { "name": "è±åˆ‡", "id": "50001049" },
                    { "name": "æ¯”è¨", "id": "50001088" },
                    { "name": "ç»´ç½—çº³", "id": "50001075" }
                ]
            });
            
            // è®¡ç®—ç”Ÿæˆçš„ API é“¾æ¥
            const generateUrl = computed(() => {
                if (!selectedTeam.value) return '';
                // æ‹¼æ¥ URLï¼Œæ³¨æ„è¦è¿›è¡Œ URL ç¼–ç é˜²æ­¢ä¸­æ–‡ä¹±ç 
                return `${apiBaseUrl}?team_id=${selectedTeam.value.id}&team_name=${encodeURIComponent(selectedTeam.value.name)}`;
            });

            // è®¡ç®—ä¾› iOS å”¤èµ·çš„ webcal:// åè®®é“¾æ¥
            // æ‰¾åˆ° setup() é‡Œçš„è¿™éƒ¨åˆ†è¿›è¡Œæ›¿æ¢
            const webcalUrl = computed(() => {
                if (!selectedTeam.value) return '';
                // å¼ºåˆ¶å°† http:// æ›¿æ¢ä¸º webcal://
                // è¿™ä¼šå‘Šè¯‰æ‰‹æœºï¼šâ€œä¸è¦ç”¨æµè§ˆå™¨æ‰“å¼€ï¼Œè¯·ç›´æ¥å”¤èµ·æ—¥å† Appâ€
                return generateUrl.value.replace("http://", "webcal://").replace("https://", "webcal://");
            });

            // å¤åˆ¶é“¾æ¥åŠŸèƒ½
            const copyLink = () => {
                if (navigator.clipboard && window.isSecureContext) {
                    navigator.clipboard.writeText(generateUrl.value);
                } else {
                    // å…¼å®¹æ—§ç‰ˆæµè§ˆå™¨
                    let textArea = document.createElement("textarea");
                    textArea.value = generateUrl.value;
                    document.body.appendChild(textArea);
                    textArea.focus();
                    textArea.select();
                    document.execCommand('copy');
                    textArea.remove();
                }
                alert("âœ… æ—¥å†è®¢é˜…é“¾æ¥å·²å¤åˆ¶ï¼å»æ—¥å† APP ä¸­ç²˜è´´è®¢é˜…å§ã€‚");
            };

            return {
                db,
                selectedLeague,
                selectedTeam,
                generateUrl,
                webcalUrl,
                copyLink
            }
        }
    }).mount('#app');
</script>
</body>
</html>